(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7ff87093"],{"11e9":function(t,e,n){var i=n("52a7"),o=n("4630"),s=n("6821"),r=n("6a99"),a=n("69a8"),l=n("c69a"),c=Object.getOwnPropertyDescriptor;e.f=n("9e1e")?c:function(t,e){if(t=s(t),e=r(e,!0),l)try{return c(t,e)}catch(n){}if(a(t,e))return o(!i.f.call(t,e),t[e])}},"55ac":function(t,e,n){"use strict";n("7a36")},"5a24":function(t,e,n){},"5dbc":function(t,e,n){var i=n("d3f4"),o=n("8b97").set;t.exports=function(t,e,n){var s,r=e.constructor;return r!==n&&"function"==typeof r&&(s=r.prototype)!==n.prototype&&i(s)&&o&&o(t,s),t}},"5df3":function(t,e,n){"use strict";var i=n("02f4")(!0);n("01f9")(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})}))},6275:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n("a026"),o=n("9225"),s=n("c0d6"),r=n("41cb"),a=function(t){var e=i["default"].extend(t);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log(t);var n=new e({i18n:o["a"],store:s["a"],router:r["a"],propsData:t}).$mount(document.createElement("div"));return new Promise((function(t,e){n.$once("completed",(function(e){return t(e)})),n.$once("cancel",(function(t){return e(t)}))}))}}},"7a36":function(t,e,n){},8054:function(t,e,n){"use strict";n("a069")},"8b97":function(t,e,n){var i=n("d3f4"),o=n("cb7c"),s=function(t,e){if(o(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{i=n("9b43")(Function.call,n("11e9").f(Object.prototype,"__proto__").set,2),i(t,[]),e=!(t instanceof Array)}catch(o){e=!0}return function(t,n){return s(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:s}},9093:function(t,e,n){var i=n("ce10"),o=n("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,o)}},a069:function(t,e,n){},aa77:function(t,e,n){var i=n("5ca1"),o=n("be13"),s=n("79e5"),r=n("fdef"),a="["+r+"]",l="​",c=RegExp("^"+a+a+"*"),u=RegExp(a+a+"*$"),d=function(t,e,n){var o={},a=s((function(){return!!r[t]()||l[t]()!=l})),c=o[t]=a?e(f):r[t];n&&(o[n]=c),i(i.P+i.F*a,"String",o)},f=d.trim=function(t,e){return t=String(o(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(u,"")),t};t.exports=d},b4ed:function(t,e,n){"use strict";n("5a24")},c5f6:function(t,e,n){"use strict";var i=n("7726"),o=n("69a8"),s=n("2d95"),r=n("5dbc"),a=n("6a99"),l=n("79e5"),c=n("9093").f,u=n("11e9").f,d=n("86cc").f,f=n("aa77").trim,h="Number",p=i[h],m=p,v=p.prototype,b=s(n("2aeb")(v))==h,g="trim"in String.prototype,y=function(t){var e=a(t,!1);if("string"==typeof e&&e.length>2){e=g?e.trim():f(e,3);var n,i,o,s=e.charCodeAt(0);if(43===s||45===s){if(n=e.charCodeAt(2),88===n||120===n)return NaN}else if(48===s){switch(e.charCodeAt(1)){case 66:case 98:i=2,o=49;break;case 79:case 111:i=8,o=55;break;default:return+e}for(var r,l=e.slice(2),c=0,u=l.length;c<u;c++)if(r=l.charCodeAt(c),r<48||r>o)return NaN;return parseInt(l,i)}}return+e};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof p&&(b?l((function(){v.valueOf.call(n)})):s(n)!=h)?r(new m(y(e)),n,p):y(e)};for(var $,_=n("9e1e")?c(m):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),k=0;_.length>k;k++)o(m,$=_[k])&&!o(p,$)&&d(p,$,u(m,$));p.prototype=v,v.constructor=p,n("2aba")(i,h,p)}},db7e:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{height:"100%"}},[n("el-row",{staticClass:"toolbar"},[n("el-button",{attrs:{type:"primary",size:"medium",icon:"el-icon-upload"},on:{click:t.onUploadClick}},[t._v(t._s(t.$t("disk.upload")))]),n("el-button",{directives:[{name:"show",rawName:"v-show",value:t.folderBtnShown,expression:"folderBtnShown"}],attrs:{type:"primary",size:"medium",icon:"el-icon-folder-add",plain:""},on:{click:t.openCreateDiglog}},[t._v(t._s(t.$t("disk.folder")))]),n("el-button-group",{directives:[{name:"show",rawName:"v-show",value:t.selectedItems.length>0,expression:"selectedItems.length > 0"}],staticStyle:{"margin-left":"10px"}},[n("el-button",{attrs:{type:"primary",icon:"el-icon-download",size:"medium",plain:""},on:{click:t.onOutlinkClick}},[t._v(t._s(t.$t("disk.download")))]),n("el-button",{attrs:{type:"primary",icon:"el-icon-delete",size:"medium",plain:""},on:{click:t.deleteSelection}},[t._v(t._s(t.$t("disk.delete")))])],1),n("div",{staticStyle:{float:"right"}},[n("el-input",{staticClass:"search",attrs:{size:"small",placeholder:t.$t("topbar.search")},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.listRefresh(e)}},model:{value:t.query.kw,callback:function(e){t.$set(t.query,"kw",e)},expression:"query.kw"}},[n("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),"list"==t.layout?n("i",{staticClass:"iconfont icon-grid",on:{click:function(e){t.layout="grid"}}}):n("i",{staticClass:"iconfont icon-list",on:{click:function(e){t.layout="list"}}})],1)],1),n("FileExplorer",{ref:"fexp",staticStyle:{height:"calc(100% - 67px)"},attrs:{layout:t.layout,dataLoader:t.dataLoader,linkLoader:t.linkLoader,rowButtons:t.rowButtons,moreButtons:t.moreButtons},on:{"selection-change":t.onSelectionChange}})],1)},o=[],s=(n("ac6a"),n("5df3"),n("7f7f"),n("b54a"),n("6275")),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-dialog",{attrs:{title:t.$t("dialog.moveto-title"),width:"30%",visible:t.visible},on:{"update:visible":function(e){t.visible=e}}},[n("el-tree",{attrs:{data:t.data,props:t.props,"node-key":"id","current-node-key":t.current.id,"default-expanded-keys":[0],load:t.loadNode,"highlight-current":!0,lazy:""},on:{"current-change":t.onCurrentChange},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.node;return n("span",{staticClass:"custom-tree-node"},[n("span",[n("i",{staticClass:"el-icon-folder"}),t._v("\n          "+t._s(i.label)+"\n        ")])])}}])}),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v(t._s(t.$t("op.confirm")))]),n("el-button",{on:{click:function(e){t.visible=!1}}},[t._v(t._s(t.$t("op.cancel")))])],1)],1)],1)},a=[],l=n("ebbf"),c={mixins:[l["a"],l["b"]],props:{alias:String,isDir:Boolean},data:function(){return{data:[],props:{label:"name",children:"folders",isLeaf:"leaf"},current:{},treectx:{}}},methods:{onCurrentChange:function(t,e){this.current=t},loadNode:function(t,e){var n=this;0!==t.level?(this.treectx.node||1!==t.level||(this.treectx.node=t,this.treectx.resolve=e),this.$zpan.File.list({sid:this.getSid(),dir:t.data.fullpath}).then((function(t){var i=t.list.filter((function(t){return t.dirtype&&t.alias!=n.alias}));e(i)}))):e([{id:0,name:"/",parent:""}])},submit:function(){var t=this;this.$zpan.File.move(this.alias,this.current.fullpath).then((function(e){t.$message({type:"success",message:t.$t("msg.move-success")}),t.finish(),t.close()}))}}},u=c,d=(n("55ac"),n("2877")),f=Object(d["a"])(u,r,a,!1,null,"6144c87d",null),h=f.exports,p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-dialog",{attrs:{title:t.$t("dialog.share-title"),width:t.shareForm.width,visible:t.visible},on:{"update:visible":function(e){t.visible=e}}},[n("el-form",{directives:[{name:"show",rawName:"v-show",value:!t.shareForm.done,expression:"!shareForm.done"}]},[n("el-form-item",{staticStyle:{"margin-left":"20px"},attrs:{label:t.$t("dialog.share-drawcode-switch")}},[n("el-switch",{model:{value:t.shareForm.private,callback:function(e){t.$set(t.shareForm,"private",e)},expression:"shareForm.private"}})],1),n("el-form-item",{staticStyle:{"margin-left":"20px"},attrs:{label:t.$t("dialog.share-expire-time")}},[n("el-select",{model:{value:t.shareForm.expire_sec,callback:function(e){t.$set(t.shareForm,"expire_sec",e)},expression:"shareForm.expire_sec"}},[n("el-option",{attrs:{label:"7 "+t.$t("day"),value:604800}}),n("el-option",{attrs:{label:"30 "+t.$t("day"),value:2592e3}}),n("el-option",{attrs:{label:"1 "+t.$t("year"),value:31536e3}}),n("el-option",{attrs:{label:"永久",value:31536e5}})],1)],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:t.shareForm.done,expression:"shareForm.done"}],staticStyle:{"margin-left":"50px","line-height":"30px"}},[n("p",[t._v("\n        "+t._s(t.$t("dialog.share-link"))+"：\n        "),n("a",{attrs:{href:t.shareForm.link,target:"_blank"}},[t._v(t._s(t.shareForm.link))])]),t.shareForm.secret?n("p",[t._v(t._s(t.$t("dialog.share-drawcode"))+"："+t._s(t.shareForm.secret))]):t._e()]),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t.shareForm.done?n("div",[n("el-button",{staticClass:"copy-link",attrs:{type:"primary","data-clipboard-text":t.shareForm.link},on:{click:t.close}},[t._v(t._s(t.$t("click-copy-link")))]),n("el-button",{on:{click:t.close}},[t._v(t._s(t.$t("op.close")))])],1):n("div",[n("el-button",{on:{click:t.close}},[t._v(t._s(t.$t("op.cancel")))]),n("el-button",{attrs:{type:"primary"},on:{click:t.share}},[t._v(t._s(t.$t("op.confirm")))])],1)])],1)],1)},m=[],v={mixins:[l["b"]],props:{alias:String},data:function(){return{shareForm:{done:!1,width:"30%",private:!1,expire_sec:604800}}},methods:{share:function(t){var e=this;this.$zpan.Share.create(this.shareForm).then((function(t){var n=window.location.origin,i=t.data.alias;e.shareForm.done=!0,e.shareForm.link="".concat(n,"/s/").concat(i),e.shareForm.secret=t.data.secret}))}},mounted:function(){this.shareForm.matter=this.alias}},b=v,g=Object(d["a"])(b,p,m,!1,null,"3d33c360",null),y=g.exports,$=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-dialog",{attrs:{title:t.$t("dialog.upload-title"),visible:t.visible,"file-list":t.fileList,"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":t.closeConfirm,width:"400px"},on:{"update:visible":function(e){t.visible=e}}},[t._v("\n    "+t._s(t.destDir)+"\n    "),n("el-upload",{ref:"uploader",staticClass:"uploader",attrs:{action:"","http-request":t.handleUpload,limit:20,"on-progress":t.handleProgress,"on-success":t.handleProgress,"on-exceed":t.handleExceed,"on-remove":t.handleRemove,drag:"",multiple:""}},[n("i",{staticClass:"el-icon-upload"}),n("div",{staticClass:"el-upload__text"},[t._v("\n        "+t._s(t.$t("dialog.upload-tips"))+"\n        "),n("em",[t._v(t._s(t.$t("dialog.upload-click")))])])])],1)],1)},_=[],k=(n("c5f6"),{mixins:[l["b"]],props:{sid:Number,destDir:String,listRefresh:Function},data:function(){return{fileList:[],uploading:!1}},methods:{closeConfirm:function(t){var e=this;this.fileList.length>0&&this.uploading?this.$confirm("文件上传中，取消将终止上传，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",customClass:"cancel-confirm"}).then((function(){e.fileList.forEach((function(t){e.$refs.uploader.abort(t)})),t()})):t()},handleProgress:function(t,e,n){this.uploading="uploading"==e.status,this.fileList=n},handleExceed:function(t,e){this.$message.warning("每次最多允许 20 个文件同时上传，请分批操作！")},handleRemove:function(t,e){this.$refs.uploader.abort(t)},handleUpload:function(t){var e,n=this,i=function(t){e=t};return t.filename=t.file.name,this.$zpan.File.upload(Number(this.sid),t,this.destDir,i).then((function(){n.completed()})),{abort:function(){e("canceled by the user")}}}}}),w=k,x=(n("8054"),Object(d["a"])(w,$,_,!1,null,null,null)),F=x.exports,C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-dialog",{attrs:{title:t.$t("dialog.outlink-title"),visible:t.visible},on:{"update:visible":function(e){t.visible=e}}},[n("div",[n("el-input",{attrs:{type:"textarea",rows:20},model:{value:t.links,callback:function(e){t.links=e},expression:"links"}})],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"}},[t._v(t._s(t.$t("click-copy-link")))]),n("el-button",{on:{click:function(e){t.visible=!1}}},[t._v(t._s(t.$t("op.close")))])],1)])],1)},S=[],E={mixins:[l["b"]],props:{items:Array},data:function(){return{links:""}},methods:{loadLinks:function(){var t=this;Promise.all(this.items.map((function(e){return t.$zpan.File.findLink(e.alias)}))).then((function(e){e.forEach((function(e){t.links+=e.link+"\r\n"}))}))}},mounted:function(){this.loadLinks()}},N=E,I=Object(d["a"])(N,C,S,!1,null,"1eff8eb1",null),B=I.exports,O={mixins:[l["a"]],data:function(){return{query:{kw:"",dir:""},layout:"list",folderBtnShown:!1,moreButtons:[{name:"move",title:this.$t("ftb.move"),action:this.move},{name:"rename",title:this.$t("ftb.rename"),action:this.rename},{name:"remove",title:this.$t("ftb.remove"),action:this.remove}],selectedItems:[]}},watch:{$route:function(t,e){this.query.type=t.query.type,this.folderBtnShown=!this.query.type}},computed:{rowButtons:function(){return 1==this.cs.mode?[{name:"download",icon:"el-icon-download",action:this.openDownload,shown:function(t){return!t.dirtype}},{name:"share",icon:"el-icon-share",action:this.share}]:[{name:"download",icon:"el-icon-download",action:this.openDownload,shown:function(t){return!t.dirtype}},{name:"viewlink",icon:"el-icon-view",action:this.viewlink}]}},methods:{dataLoader:function(t,e,n){var i=this;return t!=this.query.dir&&(this.query.dir=t),this.query.sid=this.getSid(),this.query.offset=e||0,this.query.limit=n||10,new Promise((function(t,e){i.$zpan.File.list(i.query).then((function(e){i.query.kw="",t(e)}))}))},linkLoader:function(t){var e=this;return new Promise((function(n,i){e.$zpan.File.findLink(t.alias).then((function(t){n(t.link)})).catch(i)}))},listRefresh:function(){this.$refs.fexp.listRefresh()},openDownload:function(t){this.linkLoader(t).then((function(e){var n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("download",t.name),n.click(),n.remove()}))},openCreateDiglog:function(){var t=this;this.$prompt(this.$t("tips.create-folder"),this.$t("create-folder"),{confirmButtonText:this.$t("op.confirm"),cancelButtonText:this.$t("op.cancel")}).then((function(e){var n=e.value,i={sid:t.getSid(),name:n,dir:t.query.dir,is_dir:!0};t.$zpan.File.create(i).then((function(e){t.$message({type:"success",message:t.$t("msg.create-success")}),t.listRefresh()}))}))},onUploadClick:function(){var t=this;Object(s["a"])(F)({sid:this.getSid(),destDir:this.query.dir,listRefresh:this.listRefresh}).then((function(){t.listRefresh()}))},onOutlinkClick:function(){Object(s["a"])(B)({items:this.selectedItems})},share:function(t){Object(s["a"])(y)({alias:t.alias})},viewlink:function(t){var e=this;this.linkLoader(t).then((function(t){var n=e.$createElement;e.$msgbox({title:"获取外链",message:n("p",null,t),confirmButtonText:"确定"})}))},move:function(t){var e=this;Object(s["a"])(h)({alias:t.alias,isDir:t.dirtype>0}).then((function(){e.listRefresh()}))},rename:function(t){var e=this;this.$prompt(this.$t("tips.rename"),this.$t("op.rename"),{inputValue:t.name,confirmButtonText:this.$t("op.confirm"),cancelButtonText:this.$t("op.cancel")}).then((function(n){var i=n.value;e.$zpan.File.rename(t.alias,i).then((function(t){e.$message({type:"success",message:e.$t("msg.rename-success")}),e.listRefresh()}))}))},remove:function(t){var e=this;this.$confirm(this.$t("tips.remove"),this.$t("op.delete")+" ".concat(t.name),{type:"warning",confirmButtonText:this.$t("op.confirm"),cancelButtonText:this.$t("op.cancel")}).then((function(){e.$zpan.File.delete(t.alias).then((function(t){e.$message({type:"success",message:e.$t("msg.delete-success")}),e.listRefresh()}))}))},onSelectionChange:function(t){this.selectedItems=t},deleteSelection:function(){var t=this;this.$confirm(this.$t("tips.batch-delete"),this.$t("op.batch-delete"),{type:"warning",confirmButtonText:this.$t("op.confirm"),cancelButtonText:this.$t("op.cancel")}).then((function(){var e=t.$loading({lock:!0,text:t.$t("tips.deleting"),spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Promise.all(t.selectedItems.map((function(e){return t.$zpan.File.delete(e.alias)}))).then((function(n){t.listRefresh(),e.close(),t.$message({type:"success",message:t.$t("msg.batch-delete-success")})})).catch((function(t){e.close(),console.log(t)}))}))}},mounted:function(){this.query.type=this.$route.query.type,this.folderBtnShown=!this.query.type}},L=O,q=(n("b4ed"),Object(d["a"])(L,i,o,!1,null,"431f2df4",null));e["default"]=q.exports},ebbf:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return r}));n("7f7f"),n("ac6a");var i={data:function(){return{cs:{}}},watch:{$route:function(t,e){this.setCs()}},computed:{},methods:{setCs:function(){var t=this;this.$store.state.storages.forEach((function(e){e.name==t.$route.params.sname&&(t.cs=e)}))},getSid:function(){return this.cs.id}},mounted:function(){this.setCs()}},o=i,s={data:function(){return{visible:!1}},watch:{visible:function(t){!t&&this.$destroy()}},mounted:function(){document.body.appendChild(this.$el),this.visible=!0},destroyed:function(){this.$el.parentNode.removeChild(this.$el)},methods:{open:function(){this.visible=!0},close:function(){this.visible=!1},completed:function(){this.$emit("completed")},finish:function(){this.close(),this.completed()}}},r=s},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=chunk-7ff87093.3583f6a7.js.map