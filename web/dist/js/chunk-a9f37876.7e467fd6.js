(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a9f37876"],{"116f":function(t,e,i){"use strict";i("53ad")},"11e9":function(t,e,i){var n=i("52a7"),s=i("4630"),o=i("6821"),a=i("6a99"),r=i("69a8"),l=i("c69a"),c=Object.getOwnPropertyDescriptor;e.f=i("9e1e")?c:function(t,e){if(t=o(t),e=a(e,!0),l)try{return c(t,e)}catch(i){}if(r(t,e))return s(!n.f.call(t,e),t[e])}},"53ad":function(t,e,i){},"5dbc":function(t,e,i){var n=i("d3f4"),s=i("8b97").set;t.exports=function(t,e,i){var o,a=e.constructor;return a!==i&&"function"==typeof a&&(o=a.prototype)!==i.prototype&&n(o)&&s&&s(t,o),t}},6275:function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var n=i("a026"),s=i("9225"),o=i("c0d6"),a=i("41cb"),r=function(t){var e=n["default"].extend(t);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log(t);var i=new e({i18n:s["a"],store:o["a"],router:a["a"],propsData:t}).$mount(document.createElement("div"));return new Promise((function(t,e){i.$once("completed",(function(e){return t(e)})),i.$once("cancel",(function(t){return e(t)}))}))}}},"8b97":function(t,e,i){var n=i("d3f4"),s=i("cb7c"),o=function(t,e){if(s(t),!n(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{n=i("9b43")(Function.call,i("11e9").f(Object.prototype,"__proto__").set,2),n(t,[]),e=!(t instanceof Array)}catch(s){e=!0}return function(t,i){return o(t,i),e?t.__proto__=i:n(t,i),t}}({},!1):void 0),check:o}},9093:function(t,e,i){var n=i("ce10"),s=i("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,s)}},aa77:function(t,e,i){var n=i("5ca1"),s=i("be13"),o=i("79e5"),a=i("fdef"),r="["+a+"]",l="​",c=RegExp("^"+r+r+"*"),u=RegExp(r+r+"*$"),d=function(t,e,i){var s={},r=o((function(){return!!a[t]()||l[t]()!=l})),c=s[t]=r?e(f):a[t];i&&(s[i]=c),n(n.P+n.F*r,"String",s)},f=d.trim=function(t,e){return t=String(s(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(u,"")),t};t.exports=d},bb00:function(t,e,i){"use strict";i("d7e2")},c5f6:function(t,e,i){"use strict";var n=i("7726"),s=i("69a8"),o=i("2d95"),a=i("5dbc"),r=i("6a99"),l=i("79e5"),c=i("9093").f,u=i("11e9").f,d=i("86cc").f,f=i("aa77").trim,h="Number",p=n[h],m=p,v=p.prototype,b=o(i("2aeb")(v))==h,y="trim"in String.prototype,g=function(t){var e=r(t,!1);if("string"==typeof e&&e.length>2){e=y?e.trim():f(e,3);var i,n,s,o=e.charCodeAt(0);if(43===o||45===o){if(i=e.charCodeAt(2),88===i||120===i)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:n=2,s=49;break;case 79:case 111:n=8,s=55;break;default:return+e}for(var a,l=e.slice(2),c=0,u=l.length;c<u;c++)if(a=l.charCodeAt(c),a<48||a>s)return NaN;return parseInt(l,n)}}return+e};if(!p(" 0o1")||!p("0b1")||p("+0x1")){p=function(t){var e=arguments.length<1?0:t,i=this;return i instanceof p&&(b?l((function(){v.valueOf.call(i)})):o(i)!=h)?a(new m(g(e)),i,p):g(e)};for(var $,k=i("9e1e")?c(m):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),_=0;k.length>_;_++)s(m,$=k[_])&&!s(p,$)&&d(p,$,u(m,$));p.prototype=v,v.constructor=p,i("2aba")(n,h,p)}},d7e2:function(t,e,i){},db7e:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{height:"100%"}},[i("el-row",{staticClass:"toolbar"},[i("el-button",{attrs:{type:"primary",size:"medium",icon:"el-icon-upload"},on:{click:t.onUploadClick}},[t._v(t._s(t.$t("disk.upload")))]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:t.folderBtnShown,expression:"folderBtnShown"}],attrs:{type:"primary",size:"medium",icon:"el-icon-folder-add",plain:""},on:{click:t.openCreateDiglog}},[t._v(t._s(t.$t("disk.folder")))]),i("el-button-group",{directives:[{name:"show",rawName:"v-show",value:t.selectedItems.length>0,expression:"selectedItems.length > 0"}],staticStyle:{"margin-left":"10px"}},[i("el-button",{attrs:{type:"primary",icon:"el-icon-download",size:"medium",plain:""},on:{click:t.onOutlinkClick}},[t._v(t._s(t.$t("disk.download")))]),i("el-button",{attrs:{type:"primary",icon:"el-icon-delete",size:"medium",plain:""},on:{click:t.deleteSelection}},[t._v(t._s(t.$t("disk.delete")))])],1),i("div",{staticStyle:{float:"right"}},[i("el-input",{staticClass:"search",attrs:{size:"small",placeholder:t.$t("topbar.search")},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.listRefresh(e)}},model:{value:t.query.kw,callback:function(e){t.$set(t.query,"kw",e)},expression:"query.kw"}},[i("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"prefix"},slot:"prefix"})]),"list"==t.layout?i("i",{staticClass:"iconfont icon-grid",on:{click:function(e){t.layout="grid"}}}):i("i",{staticClass:"iconfont icon-list",on:{click:function(e){t.layout="list"}}})],1)],1),i("FileExplorer",{ref:"fexp",staticStyle:{height:"calc(100% - 67px)"},attrs:{layout:t.layout,dataLoader:t.dataLoader,linkLoader:t.linkLoader,rowButtons:t.rowButtons,moreButtons:t.moreButtons},on:{"selection-change":t.onSelectionChange}})],1)},s=[],o=(i("ac6a"),i("5df3"),i("7f7f"),i("b54a"),i("6275")),a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-dialog",{attrs:{title:t.$t("dialog.moveto-title"),width:"30%",visible:t.visible},on:{"update:visible":function(e){t.visible=e}}},[i("el-tree",{attrs:{data:t.data,props:t.props,"node-key":"id","current-node-key":t.current.id,"default-expanded-keys":[0],load:t.loadNode,"highlight-current":!0,lazy:""},on:{"current-change":t.onCurrentChange},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.node;return i("span",{staticClass:"custom-tree-node"},[i("span",[i("i",{staticClass:"el-icon-folder"}),t._v("\n          "+t._s(n.label)+"\n        ")])])}}])}),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v(t._s(t.$t("confirm")))]),i("el-button",{on:{click:function(e){t.visible=!1}}},[t._v(t._s(t.$t("cancel")))])],1)],1)],1)},r=[],l=i("ebbf"),c={mixins:[l["a"],l["b"]],props:{alias:String,isDir:Boolean},data:function(){return{data:[],props:{label:"name",children:"folders",isLeaf:"leaf"},current:{},treectx:{}}},methods:{onCurrentChange:function(t,e){this.current=t},loadNode:function(t,e){var i=this;0!==t.level?(this.treectx.node||1!==t.level||(this.treectx.node=t,this.treectx.resolve=e),this.$zpan.File.list({sid:this.getSid(),dir:t.data.fullpath}).then((function(t){var n=t.list.filter((function(t){return t.dirtype&&t.alias!=i.alias}));e(n)}))):e([{id:0,name:"/",parent:""}])},submit:function(){var t=this;this.$zpan.File.move(this.alias,this.current.fullpath).then((function(e){t.$message({type:"success",message:t.$t("msg.move-success")}),t.finish(),t.close()}))}}},u=c,d=(i("bb00"),i("2877")),f=Object(d["a"])(u,a,r,!1,null,"776c9967",null),h=f.exports,p=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-dialog",{attrs:{title:t.$t("dialog.share-title"),width:t.shareForm.width,visible:t.visible},on:{"update:visible":function(e){t.visible=e}}},[i("el-form",{directives:[{name:"show",rawName:"v-show",value:!t.shareForm.done,expression:"!shareForm.done"}]},[i("el-form-item",{staticStyle:{"margin-left":"20px"},attrs:{label:t.$t("dialog.share-drawcode-switch")}},[i("el-switch",{model:{value:t.shareForm.private,callback:function(e){t.$set(t.shareForm,"private",e)},expression:"shareForm.private"}})],1),i("el-form-item",{staticStyle:{"margin-left":"20px"},attrs:{label:t.$t("dialog.share-expire-time")}},[i("el-select",{model:{value:t.shareForm.expire_sec,callback:function(e){t.$set(t.shareForm,"expire_sec",e)},expression:"shareForm.expire_sec"}},[i("el-option",{attrs:{label:"7 "+t.$t("day"),value:604800}}),i("el-option",{attrs:{label:"30 "+t.$t("day"),value:2592e3}}),i("el-option",{attrs:{label:"1 "+t.$t("year"),value:31536e3}})],1)],1)],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.shareForm.done,expression:"shareForm.done"}],staticStyle:{"margin-left":"50px","line-height":"30px"}},[i("p",[t._v("\n        "+t._s(t.$t("dialog.share-link"))+"：\n        "),i("a",{attrs:{href:t.shareForm.link,target:"_blank"}},[t._v(t._s(t.shareForm.link))])]),t.shareForm.secret?i("p",[t._v(t._s(t.$t("dialog.share-drawcode"))+"："+t._s(t.shareForm.secret))]):t._e()]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t.shareForm.done?i("div",[i("el-button",{staticClass:"copy-link",attrs:{type:"primary","data-clipboard-text":t.shareForm.link},on:{click:t.close}},[t._v(t._s(t.$t("click-copy-link")))]),i("el-button",{on:{click:t.close}},[t._v(t._s(t.$t("close")))])],1):i("div",[i("el-button",{on:{click:t.close}},[t._v(t._s(t.$t("cancel")))]),i("el-button",{attrs:{type:"primary"},on:{click:t.share}},[t._v(t._s(t.$t("confirm")))])],1)])],1)],1)},m=[],v={mixins:[l["b"]],props:{alias:String},data:function(){return{shareForm:{done:!1,width:"30%",private:!1,expire_sec:604800}}},methods:{share:function(t){var e=this;this.$zpan.Share.create(this.shareForm).then((function(t){var i=window.location.origin,n=t.data.alias;e.shareForm.done=!0,e.shareForm.link="".concat(i,"/s/").concat(n),e.shareForm.secret=t.data.secret}))}},mounted:function(){this.shareForm.matter=this.alias}},b=v,y=Object(d["a"])(b,p,m,!1,null,"ba1d9908",null),g=y.exports,$=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-dialog",{attrs:{title:t.$t("dialog.upload-title"),visible:t.visible,width:"400px"},on:{"update:visible":function(e){t.visible=e}}},[t._v("\n    "+t._s(t.destDir)+"\n    "),i("el-upload",{staticClass:"upload-demo",attrs:{action:"","http-request":t.handleUpload,"file-list":t.fileList,limit:20,"on-exceed":t.handleExceed,drag:"",multiple:""}},[i("i",{staticClass:"el-icon-upload"}),i("div",{staticClass:"el-upload__text"},[t._v("\n        "+t._s(t.$t("dialog.upload-tips"))+"\n        "),i("em",[t._v(t._s(t.$t("dialog.upload-click")))])])])],1)],1)},k=[],_=(i("c5f6"),{mixins:[l["b"]],props:{sid:Number,destDir:String},data:function(){return{fileList:[]}},watch:{visible:function(t,e){this.fileList=[]}},methods:{handleExceed:function(t,e){this.$message.warning("每次最多允许 20 个文件同时上传，请分批操作！")},handleUpload:function(t){t.filename=t.file.name,this.$zpan.File.upload(Number(this.sid),t,this.destDir).then(this.finish)}}}),w=_,x=Object(d["a"])(w,$,k,!1,null,"59184535",null),F=x.exports,C=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-dialog",{attrs:{title:t.$t("dialog.outlink-title"),visible:t.visible},on:{"update:visible":function(e){t.visible=e}}},[i("div",[i("el-input",{attrs:{type:"textarea",rows:20},model:{value:t.links,callback:function(e){t.links=e},expression:"links"}})],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"}},[t._v(t._s(t.$t("click-copy-link")))]),i("el-button",{on:{click:function(e){t.visible=!1}}},[t._v(t._s(t.$t("close")))])],1)])],1)},S=[],E={mixins:[l["b"]],props:{items:Array},data:function(){return{links:""}},methods:{loadLinks:function(){var t=this;Promise.all(this.items.map((function(e){return t.$zpan.File.findLink(e.alias)}))).then((function(e){e.forEach((function(e){t.links+=e.link+"\r\n"}))}))}},mounted:function(){this.loadLinks()}},N=E,I=Object(d["a"])(N,C,S,!1,null,"3aef677c",null),O=I.exports,B={mixins:[l["a"]],data:function(){return{query:{kw:"",dir:""},layout:"list",folderBtnShown:!1,moreButtons:[{name:"move",title:this.$t("ftb.move"),action:this.move},{name:"rename",title:this.$t("ftb.rename"),action:this.rename},{name:"remove",title:this.$t("ftb.remove"),action:this.remove}],selectedItems:[]}},watch:{$route:function(t,e){this.query.type=t.query.type,this.folderBtnShown=!this.query.type}},computed:{rowButtons:function(){return 1==this.cs.mode?[{name:"download",icon:"el-icon-download",action:this.openDownload,shown:function(t){return!t.dirtype}},{name:"share",icon:"el-icon-share",action:this.share}]:[{name:"download",icon:"el-icon-download",action:this.openDownload,shown:function(t){return!t.dirtype}},{name:"viewlink",icon:"el-icon-view",action:this.viewlink}]}},methods:{dataLoader:function(t,e,i){var n=this;return t!=this.query.dir&&(this.query.dir=t),this.query.sid=this.getSid(),this.query.offset=e||0,this.query.limit=i||10,new Promise((function(t,e){n.$zpan.File.list(n.query).then((function(e){n.query.kw="",t(e)}))}))},linkLoader:function(t){var e=this;return new Promise((function(i,n){e.$zpan.File.findLink(t.alias).then((function(t){i(t.link)})).catch(n)}))},listRefresh:function(){this.$refs.fexp.listRefresh()},openDownload:function(t){this.linkLoader(t).then((function(e){var i=document.createElement("a");i.href=e,i.download=t.name,i.click()}))},openCreateDiglog:function(){var t=this;this.$prompt(this.$t("tips.create-folder"),this.$t("create-folder"),{confirmButtonText:this.$t("confirm"),cancelButtonText:this.$t("cancel")}).then((function(e){var i=e.value,n={sid:t.getSid(),name:i,dir:t.query.dir,is_dir:!0};t.$zpan.File.create(n).then((function(e){t.$message({type:"success",message:t.$t("msg.create-success")}),t.listRefresh()}))}))},onUploadClick:function(){var t=this;Object(o["a"])(F)({sid:this.getSid(),destDir:this.query.dir}).then((function(){t.listRefresh()}))},onOutlinkClick:function(){Object(o["a"])(O)({items:this.selectedItems})},share:function(t){Object(o["a"])(g)({alias:t.alias})},viewlink:function(t){var e=this;this.linkLoader(t).then((function(t){var i=e.$createElement;e.$msgbox({title:"获取外链",message:i("p",null,t),confirmButtonText:"确定"})}))},move:function(t){var e=this;Object(o["a"])(h)({alias:t.alias,isDir:t.dirtype>0}).then((function(){e.listRefresh()}))},rename:function(t){var e=this;this.$prompt(this.$t("tips.rename"),this.$t("rename"),{inputValue:t.name,confirmButtonText:this.$t("confirm"),cancelButtonText:this.$t("cancel")}).then((function(i){var n=i.value;e.$zpan.File.rename(t.alias,n).then((function(t){e.$message({type:"success",message:e.$t("msg.rename-success")}),e.listRefresh()}))}))},remove:function(t){var e=this;this.$confirm(this.$t("tips.remove"),this.$t("delete")+" ".concat(t.name),{type:"warning",confirmButtonText:this.$t("confirm"),cancelButtonText:this.$t("cancel")}).then((function(){e.$zpan.File.delete(t.alias).then((function(t){e.$message({type:"success",message:e.$t("msg.delete-success")}),e.listRefresh()}))}))},onSelectionChange:function(t){this.selectedItems=t},deleteSelection:function(){var t=this;this.$confirm(this.$t("tips.batch-delete"),this.$t("batch-delete"),{type:"warning",confirmButtonText:this.$t("confirm"),cancelButtonText:this.$t("cancel")}).then((function(){var e=t.$loading({lock:!0,text:t.$t("tips.deleting"),spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});Promise.all(t.selectedItems.map((function(e){return t.$zpan.File.delete(e.alias)}))).then((function(i){t.listRefresh(),e.close(),t.$message({type:"success",message:t.$t("msg.batch-delete-success")})})).catch((function(t){e.close(),console.log(t)}))}))}},mounted:function(){this.query.type=this.$route.query.type,this.folderBtnShown=!this.query.type}},q=B,L=(i("116f"),Object(d["a"])(q,n,s,!1,null,"25b3eb6e",null));e["default"]=L.exports},ebbf:function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"b",(function(){return a}));i("7f7f"),i("ac6a");var n={data:function(){return{cs:{}}},watch:{$route:function(t,e){this.setCs()}},computed:{},methods:{setCs:function(){var t=this;this.$store.state.storages.forEach((function(e){e.name==t.$route.params.sname&&(t.cs=e)}))},getSid:function(){return this.cs.id}},mounted:function(){this.setCs()}},s=n,o={data:function(){return{visible:!1}},watch:{visible:function(t){!t&&this.$destroy()}},mounted:function(){document.body.appendChild(this.$el),this.visible=!0},destroyed:function(){this.$el.parentNode.removeChild(this.$el)},methods:{open:function(){this.visible=!0},close:function(){this.visible=!1},finish:function(){this.visible=!1,this.$emit("completed")}}},a=o},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=chunk-a9f37876.7e467fd6.js.map