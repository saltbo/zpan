(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c35cc142"],{"02b5":function(t,s,e){},"0a6e":function(t,s,e){"use strict";e("02b5")},a25c:function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("section",[e("Topbar"),e("div",{staticClass:"installer"},[e("el-card",{staticStyle:{padding:"40px"},attrs:{shadow:"never"}},[e("el-steps",{staticClass:"step",attrs:{active:t.step,"finish-status":"success"}},[e("el-step",{attrs:{title:"配置数据库"}}),e("el-step",{attrs:{title:"配置管理员账号"}}),e("el-step",{attrs:{title:"安装完成"}})],1),e("el-form",{directives:[{name:"show",rawName:"v-show",value:t.stepShown(0),expression:"stepShown(0)"}],staticClass:"form",attrs:{model:t.form.database,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"数据库类型",prop:"driver"}},[e("el-radio-group",{model:{value:t.form.database.driver,callback:function(s){t.$set(t.form.database,"driver",s)},expression:"form.database.driver"}},[e("el-radio",{attrs:{label:"sqlite3"}}),e("el-radio",{attrs:{label:"mysql"}}),e("el-radio",{attrs:{label:"postgres"}}),e("el-radio",{attrs:{label:"mssql"}})],1)],1),e("el-form-item",{attrs:{label:"DSN",prop:"dsn"}},[e("el-input",{model:{value:t.form.database.dsn,callback:function(s){t.$set(t.form.database,"dsn",s)},expression:"form.database.dsn"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:function(s){t.step++}}},[t._v("下一步")])],1)],1),e("el-form",{directives:[{name:"show",rawName:"v-show",value:t.stepShown(1),expression:"stepShown(1)"}],ref:"form",staticClass:"form",attrs:{model:t.form.administrator,rules:t.rules,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"管理员账号",prop:"email"}},[e("el-input",{model:{value:t.form.administrator.email,callback:function(s){t.$set(t.form.administrator,"email",s)},expression:"form.administrator.email"}})],1),e("el-form-item",{attrs:{label:"管理员密码",prop:"password"}},[e("el-input",{attrs:{type:"password"},model:{value:t.form.administrator.password,callback:function(s){t.$set(t.form.administrator,"password",s)},expression:"form.administrator.password"}})],1),e("el-form-item",{attrs:{label:"密码确认",prop:"passwordr"}},[e("el-input",{attrs:{type:"password"},model:{value:t.form.administrator.passwordr,callback:function(s){t.$set(t.form.administrator,"passwordr",s)},expression:"form.administrator.passwordr"}})],1),e("el-form-item",[e("el-button",{on:{click:function(s){t.step--}}},[t._v("上一步")]),e("el-button",{attrs:{type:"primary"},on:{click:function(s){return t.submitForm("form")}}},[t._v("开始安装")])],1)],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.stepShown(3),expression:"stepShown(3)"}],staticStyle:{"text-align":"center"}},[e("h3",{staticStyle:{"margin-bottom":"50px"}},[t._v("恭喜！ZPan安装成功啦~")]),e("el-button",{attrs:{type:"primary"},on:{click:t.toSignin}},[t._v("去登录")])],1)],1)],1)],1)},r=[],o=e("0b47"),i={components:{Topbar:o["a"]},data(){var t=(t,s,e)=>{s?(""!==this.form.administrator.passwordr&&this.$refs.form.validateField("passwordr"),e()):e(new Error("请输入密码"))},s=(t,s,e)=>{s?s!==this.form.administrator.password?e(new Error("两次输入密码不一致!")):e():e(new Error("请再次输入密码"))};return{step:0,dsns:{sqlite3:"zpan.db",mysql:"user:pass@tcp(127.0.0.1:3306)/zpan?charset=utf8mb4&parseTime=True&loc=Local",postgres:"host=localhost user=admin password=admin dbname=zpan port=9920 sslmode=disable TimeZone=Asia/Shanghai",mssql:"sqlserver://zpan:LoremIpsum86@localhost:9930?database=zpan"},form:{database:{driver:"sqlite3",dsn:"zpan.db"},administrator:{email:"admin@zpan.space"}},rules:{email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}],password:[{validator:t,trigger:"blur",required:!0}],passwordr:[{validator:s,trigger:"blur",required:!0}]}}},watch:{"form.database.driver"(t,s){this.form.database.dsn=this.dsns[t]}},computed:{},methods:{stepShown(t){return this.step==t},submitForm(t){this.$refs[t].validate(t=>{console.log(t),t?(console.log(this.form),this.$zpan.System.installDatabase(this.form.database).then(t=>{setTimeout(()=>{this.$zpan.System.createAdministrator(this.form.administrator).then(()=>{this.$message({type:"success",message:"安装成功"}),this.step++,this.step++})},1e3)})):console.log("error submit!!")})},toSignin(){this.$router.push({name:"signin",params:{email:this.form.administrator.email}})}}},l=i,n=(e("0a6e"),e("2877")),m=Object(n["a"])(l,a,r,!1,null,null,null);s["default"]=m.exports}}]);