(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e380101a"],{"0bf7":function(t,e,s){"use strict";s("2996")},2996:function(t,e,s){},6275:function(t,e,s){"use strict";s.d(e,"a",(function(){return l}));var i=s("8bbf"),a=s.n(i),n=s("9225"),o=s("c0d6"),r=s("41cb");const l=t=>{const e=a.a.extend(t);return function(t={}){console.log(t);let s=new e({i18n:n["a"],store:o["a"],router:r["a"],propsData:t}).$mount(document.createElement("div"));return new Promise((t,e)=>{s.$once("completed",e=>t(e)),s.$once("cancel",t=>e(t))})}}},"8e6b":function(t,e,s){"use strict";var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-dialog",{attrs:{title:t.$t("dialog.outlink-title"),visible:t.visible},on:{"update:visible":function(e){t.visible=e}}},[s("div",[s("el-input",{attrs:{type:"textarea",rows:20},model:{value:t.links,callback:function(e){t.links=e},expression:"links"}})],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"}},[t._v(t._s(t.$t("click-copy-link")))]),s("el-button",{on:{click:function(e){t.visible=!1}}},[t._v(t._s(t.$t("op.close")))])],1)])],1)},a=[],n=s("ebbf"),o={mixins:[n["b"]],props:{items:Array},data(){return{links:""}},methods:{loadLinks(){Promise.all(this.items.map(t=>this.$zpan.File.get(t.alias))).then(t=>{t.forEach(t=>{this.links+=t.url+"\r\n"})})}},mounted(){this.loadLinks()}},r=o,l=s("2877"),c=Object(l["a"])(r,i,a,!1,null,"ffee72ca",null);e["a"]=c.exports},ce0d:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("Topbar"),s("div",{staticStyle:{margin:"20px 50px"}},[t.matter.id?t.matter.dirtype?s("el-card",{staticClass:"folder-card",attrs:{shadow:"never","body-style":"height: 100%"}},[s("div",{staticClass:"header clearfix",attrs:{slot:"header"},slot:"header"},[s("div",[s("span",{staticClass:"name"},[t._v(t._s(t.matter.name))]),s("div",{staticStyle:{float:"right"}},[s("el-button",{attrs:{type:"primary",size:"medium",icon:"el-icon-download"},on:{click:t.onDownloadClick}},[t._v("下载")])],1)]),s("p",{staticClass:"time"},[s("i",{staticClass:"el-icon-time"}),s("span",[t._v(t._s(t._f("moment")(t.matter.created,"YYYY-MM-DD HH:hh")))]),s("span",[t._v("失效时间："+t._s(t.expireTime))])])]),s("FileExplorer",{ref:"fexp",staticStyle:{height:"calc(100% - 80px)"},attrs:{dataLoader:t.dataLoader,linkLoader:t.linkLoader,rowButtons:t.rowButtons,rootDir:t.rootDir},on:{"selection-change":t.onSelectionChange}})],1):t.info.id?s("el-card",{staticClass:"file-card",attrs:{shadow:"never"}},[s("div",{staticClass:"header clearfix",attrs:{slot:"header"},slot:"header"},[s("div",[s("span",{staticClass:"name"},[t._v(t._s(t.matter.name))]),s("div",{staticStyle:{float:"right"}},[s("el-button",{attrs:{type:"primary",size:"medium",icon:"el-icon-download"},on:{click:function(e){return t.openDownload(t.matter)}}},[t._v("下载")])],1)]),s("p",{staticClass:"time"},[s("i",{staticClass:"el-icon-time"}),s("span",[t._v(t._s(t._f("moment")(t.matter.created,"YYYY-MM-DD HH:hh")))]),s("span",[t._v("失效时间："+t._s(t.expireTime))])])]),s("div",{staticClass:"content"},[s("div",[s("i",{staticClass:"el-icon-document"}),s("p",[t._v("文件大小："+t._s(t.matter.size))])])])]):t._e():s("el-empty",{attrs:{description:"分享已失效"}},[s("el-button",{attrs:{type:"primary"}},[t._v("去分享者主页")])],1)],1)],1)},a=[],n=s("6275"),o=s("90fe"),r=s("8e6b"),l=s("0b47"),c={components:{Topbar:l["a"]},data(){return{rowButtons:[{name:"download",icon:"el-icon-download",action:this.openDownload,shown:t=>!t.dirtype}],info:{},matter:{},selectedItems:[]}},computed:{layout(){return this.info.type?"file":"folder"},rootDir(){return`${this.matter.parent}${this.matter.name}/`},expireTime(){if(this.info.expire_at)return this.info.expire_at.moment()}},methods:{dataLoader(t){return new Promise((e,s)=>{if(!this.info.id||this.info.type)return;let i=this.$route.params.alias;this.$zpan.Share.listMatters(i,{dir:t}).then(t=>{let s=t.data;s.list=s.list.map(t=>(t.size=o["a"].formatBytes(t.size,1),t.fullpath=`${t.parent}${t.name}`,t.dirtype&&(t.fullpath+="/"),t)),e(s)})})},linkLoader(t){return new Promise((e,s)=>{this.$zpan.File.get(t.alias).then(t=>{e(t.url)}).catch(s)})},openDownload(t){this.linkLoader(t).then(e=>{var s=document.createElement("a");s.href=e,s.download=t.name,s.click()})},onSelectionChange(t){this.selectedItems=t},onDownloadClick(t){0==this.selectedItems.length?this.$message({type:"warning",message:"您还没有选择下载的文件"}):1==this.selectedItems.length?this.openDownload(this.selectedItems[0]):Object(n["a"])(r["a"])({items:this.selectedItems})},listRefresh(t){this.$zpan.Share.findMatter(t).then(t=>{this.matter=t.data,this.matter.size=o["a"].formatBytes(this.matter.size,1),this.$refs.fexp&&this.$refs.fexp.listRefresh()}).catch(t=>{console.log(12,t)})}},watch:{$route(t){this.listRefresh(t.params.alias)}},mounted(){let t=this.$route.params.alias;this.$zpan.Share.find(t).then(e=>{let s=e.data;s.protected&&localStorage.getItem("zpan-share")!=t?this.$router.push({name:"share-draw"}):(this.info=s,this.listRefresh(t),document.title=s.name+" | Zpan")})}},d=c,h=(s("0bf7"),s("2877")),m=Object(h["a"])(d,i,a,!1,null,"6765dc94",null);e["default"]=m.exports},ebbf:function(t,e,s){"use strict";s.d(e,"a",(function(){return a})),s.d(e,"b",(function(){return o}));const i={data(){return{cs:{}}},watch:{$route(t,e){this.setCs()}},computed:{},methods:{setCs(){this.$store.state.storages.forEach(t=>{t.name==this.$route.params.sname&&(this.cs=t)})},getSid(){return this.cs.id}},mounted(){this.setCs()}};var a=i;const n={data(){return{visible:!1}},watch:{visible(t){!t&&this.$destroy()}},mounted(){document.body.appendChild(this.$el),this.visible=!0},destroyed(){this.$el.parentNode.removeChild(this.$el)},methods:{open(){this.visible=!0},close(){this.visible=!1},completed(){this.$emit("completed")},finish(){this.close(),this.completed()}}};var o=n}}]);